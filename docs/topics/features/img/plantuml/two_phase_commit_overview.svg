<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1799px" preserveAspectRatio="none" style="width:1190px;height:1799px;background:#F0F8FF;" version="1.1" viewBox="0 0 1190 1799" width="1190px" zoomAndPan="magnify"><defs/><g><rect fill="#F0F8FF" height="1799" style="stroke:none;stroke-width:1.0;" width="1190" x="0" y="0"/><text fill="#333333" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="362" x="410" y="28.5352">Two-Phase Transaction Commit: All Unlock Paths</text><rect fill="#FFFFFF" height="350.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="189.5" y="210.0859"/><rect fill="#FFFFFF" height="247.75" style="stroke:#181818;stroke-width:1.0;" width="10" x="647.5" y="1146.8652"/><rect fill="#FFFFFF" height="71.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="944" y="736.9414"/><rect fill="#FFFFFF" height="116.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="944" y="1030.623"/><rect fill="none" height="1062.5977" style="stroke:#000000;stroke-width:1.5;" width="1026.5" x="146.5" y="421.2598"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="135.4648" y2="1686.6523"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="194.5" x2="194.5" y1="135.4648" y2="1686.6523"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="409" x2="409" y1="135.4648" y2="1686.6523"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="652" x2="652" y1="135.4648" y2="1686.6523"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="848.5" x2="848.5" y1="135.4648" y2="1686.6523"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="948.5" x2="948.5" y1="135.4648" y2="1686.6523"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1114.5" x2="1114.5" y1="135.4648" y2="1686.6523"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="5" y="116.0234">Transaction</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="22" y="132.5117">Source</text><ellipse cx="48.5" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.5,58.9883 L48.5,85.9883 M35.5,66.9883 L61.5,66.9883 M48.5,85.9883 L35.5,100.9883 M48.5,85.9883 L61.5,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="5" y="1699.1875">Transaction</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="22" y="1715.6758">Source</text><ellipse cx="48.5" cy="1727.1289" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.5,1735.1289 L48.5,1762.1289 M35.5,1743.1289 L61.5,1743.1289 M48.5,1762.1289 L35.5,1777.1289 M48.5,1762.1289 L61.5,1777.1289 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="76" x="156.5" y="103.9766"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="163.5" y="124.5117">Validator</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="76" x="156.5" y="1685.6523"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="163.5" y="1706.1875">Validator</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="367" y="132.5117">UTXO Store</text><path d="M391.5,82.9766 C391.5,72.9766 409.5,72.9766 409.5,72.9766 C409.5,72.9766 427.5,72.9766 427.5,82.9766 L427.5,108.9766 C427.5,118.9766 409.5,118.9766 409.5,118.9766 C409.5,118.9766 391.5,118.9766 391.5,108.9766 L391.5,82.9766 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M391.5,82.9766 C391.5,92.9766 409.5,92.9766 409.5,92.9766 C409.5,92.9766 427.5,92.9766 427.5,82.9766 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="367" y="1699.1875">UTXO Store</text><path d="M391.5,1712.1406 C391.5,1702.1406 409.5,1702.1406 409.5,1702.1406 C409.5,1702.1406 427.5,1702.1406 427.5,1712.1406 L427.5,1738.1406 C427.5,1748.1406 409.5,1748.1406 409.5,1748.1406 C409.5,1748.1406 391.5,1748.1406 391.5,1738.1406 L391.5,1712.1406 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M391.5,1712.1406 C391.5,1722.1406 409.5,1722.1406 409.5,1722.1406 C409.5,1722.1406 427.5,1722.1406 427.5,1712.1406 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="119" x="593" y="103.9766"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="600" y="124.5117">Block Assembly</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="119" x="593" y="1685.6523"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="600" y="1706.1875">Block Assembly</text><path d="M824.5,108.9766 L872.5,108.9766 C877.5,108.9766 877.5,122.2207 877.5,122.2207 C877.5,122.2207 877.5,135.4648 872.5,135.4648 L824.5,135.4648 C819.5,135.4648 819.5,122.2207 819.5,122.2207 C819.5,122.2207 819.5,108.9766 824.5,108.9766 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M872.5,108.9766 C867.5,108.9766 867.5,122.2207 867.5,122.2207 C867.5,135.4648 872.5,135.4648 872.5,135.4648 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="824.5" y="127.5117">Kafka</text><path d="M824.5,1685.6523 L872.5,1685.6523 C877.5,1685.6523 877.5,1698.8965 877.5,1698.8965 C877.5,1698.8965 877.5,1712.1406 872.5,1712.1406 L824.5,1712.1406 C819.5,1712.1406 819.5,1698.8965 819.5,1698.8965 C819.5,1698.8965 819.5,1685.6523 824.5,1685.6523 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M872.5,1685.6523 C867.5,1685.6523 867.5,1698.8965 867.5,1698.8965 C867.5,1712.1406 872.5,1712.1406 872.5,1712.1406 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="824.5" y="1704.1875">Kafka</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="123" x="887.5" y="103.9766"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="894.5" y="124.5117">Block Validation</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="123" x="887.5" y="1685.6523"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="894.5" y="1706.1875">Block Validation</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="1075.5" y="132.5117">Blockchain</text><ellipse cx="1115" cy="102.9766" fill="#DDDDDD" rx="12" ry="12" style="stroke:#666666;stroke-width:0.5;"/><line style="stroke:#666666;stroke-width:0.5;" x1="1103" x2="1127" y1="116.9766" y2="116.9766"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="1075.5" y="1699.1875">Blockchain</text><ellipse cx="1115" cy="1718.1406" fill="#DDDDDD" rx="12" ry="12" style="stroke:#666666;stroke-width:0.5;"/><line style="stroke:#666666;stroke-width:0.5;" x1="1103" x2="1127" y1="1732.1406" y2="1732.1406"/><rect fill="#FFFFFF" height="350.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="189.5" y="210.0859"/><rect fill="#FFFFFF" height="247.75" style="stroke:#181818;stroke-width:1.0;" width="10" x="647.5" y="1146.8652"/><rect fill="#FFFFFF" height="71.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="944" y="736.9414"/><rect fill="#FFFFFF" height="116.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="944" y="1030.623"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1183" x="0" y="166.1201"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1183" y1="166.1201" y2="166.1201"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1183" y1="169.1201" y2="169.1201"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="109" x="537" y="155.4648"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="543" y="172.0332">Phase 1: Lock</text><polygon fill="#666666" points="177.5,206.0859,187.5,210.0859,177.5,214.0859,181.5,210.0859" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="48.5" x2="183.5" y1="210.0859" y2="210.0859"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="55.5" y="205.3438">Submit Transaction</text><line style="stroke:#666666;stroke-width:1.0;" x1="199.5" x2="241.5" y1="239.3965" y2="239.3965"/><line style="stroke:#666666;stroke-width:1.0;" x1="241.5" x2="241.5" y1="239.3965" y2="252.3965"/><line style="stroke:#666666;stroke-width:1.0;" x1="200.5" x2="241.5" y1="252.3965" y2="252.3965"/><polygon fill="#666666" points="210.5,248.3965,200.5,252.3965,210.5,256.3965,206.5,252.3965" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="206.5" y="234.6543">Validate transaction</text><polygon fill="#666666" points="397.5,293.0176,407.5,297.0176,397.5,301.0176,401.5,297.0176" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="199.5" x2="403.5" y1="297.0176" y2="297.0176"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="206.5" y="276.9648">Create UTXOs</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="206.5" y="292.2754">(locked=true)</text><path d="M414,310.0176 L414,365.0176 L595,365.0176 L595,320.0176 L585,310.0176 L414,310.0176 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M585,310.0176 L585,320.0176 L595,320.0176 L585,310.0176 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121" x="420" y="327.5859">Phase 1 Complete</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="420" y="342.8965">UTXOs created as locked.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="420" y="358.207">Cannot be spent yet.</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1183" x="0" y="391.6045"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1183" y1="391.6045" y2="391.6045"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1183" y1="394.6045" y2="394.6045"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="251" x="466" y="380.9492"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="233" x="472" y="397.5176">Decision Point: Which Unlock Path?</text><path d="M146.5,421.2598 L208.5,421.2598 L208.5,428.5703 L198.5,438.5703 L146.5,438.5703 L146.5,421.2598 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1062.5977" style="stroke:#000000;stroke-width:1.5;" width="1026.5" x="146.5" y="421.2598"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="161.5" y="434.8281">alt</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="223.5" y="433.8945">[</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142" x="227.5" y="433.8945">Path 1: Normal Operation</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="84" x="373.5" y="433.8945">(Primary Path)]</text><polygon fill="#666666" points="640.5,455.8809,650.5,459.8809,640.5,463.8809,644.5,459.8809" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="199.5" x2="646.5" y1="459.8809" y2="459.8809"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="206.5" y="455.1387">Store()</text><polygon fill="#666666" points="836.5,485.1914,846.5,489.1914,836.5,493.1914,840.5,489.1914" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="199.5" x2="842.5" y1="489.1914" y2="489.1914"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="206.5" y="484.4492">Publish tx metadata</text><line style="stroke:#666666;stroke-width:1.0;" x1="199.5" x2="241.5" y1="518.502" y2="518.502"/><line style="stroke:#666666;stroke-width:1.0;" x1="241.5" x2="241.5" y1="518.502" y2="531.502"/><line style="stroke:#666666;stroke-width:1.0;" x1="200.5" x2="241.5" y1="531.502" y2="531.502"/><polygon fill="#666666" points="210.5,527.502,200.5,531.502,210.5,535.502,206.5,531.502" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="206.5" y="513.7598">twoPhaseCommitTransaction()</text><polygon fill="#666666" points="397.5,556.8125,407.5,560.8125,397.5,564.8125,401.5,560.8125" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="194.5" x2="403.5" y1="560.8125" y2="560.8125"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="201.5" y="556.0703">SetLocked(txHash, false)</text><path d="M414,573.8125 L414,644.8125 L604,644.8125 L604,583.8125 L594,573.8125 L414,573.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M594,573.8125 L594,583.8125 L604,583.8125 L594,573.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="153" x="420" y="591.3809">Unlock Path 1: Primary</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="420" y="606.6914">Normal validation flow.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="420" y="622.002">Happens immediately after</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="420" y="637.3125">Block Assembly + Kafka.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="146.5" x2="1173" y1="651.0547" y2="651.0547"/><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="151.5" y="661.6895">[</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="146" x="155.5" y="661.6895">Path 2: Transaction Mined</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="86" x="305.5" y="661.6895">(Fallback Path)]</text><path d="M158,670.0098 L158,695.0098 L1151,695.0098 L1151,680.0098 L1141,670.0098 L158,670.0098 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1141,670.0098 L1141,680.0098 L1151,680.0098 L1141,670.0098 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="504.5" y="687.5781">If Path 1 unlock fails, Path 2 acts as safety net</text><polygon fill="#666666" points="965,732.9414,955,736.9414,965,740.9414,961,736.9414" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="959" x2="1114" y1="736.9414" y2="736.9414"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="971" y="716.8887">Block received</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="971" y="732.1992">containing transaction</text><line style="stroke:#666666;stroke-width:1.0;" x1="954" x2="996" y1="766.252" y2="766.252"/><line style="stroke:#666666;stroke-width:1.0;" x1="996" x2="996" y1="766.252" y2="779.252"/><line style="stroke:#666666;stroke-width:1.0;" x1="955" x2="996" y1="779.252" y2="779.252"/><polygon fill="#666666" points="965,775.252,955,779.252,965,783.252,961,779.252" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="961" y="761.5098">Validate block</text><polygon fill="#666666" points="420.5,804.5625,410.5,808.5625,420.5,812.5625,416.5,808.5625" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="414.5" x2="948" y1="808.5625" y2="808.5625"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="426.5" y="803.8203">SetMinedMulti()</text><path d="M414,821.5625 L414,922.5625 L627,922.5625 L627,831.5625 L617,821.5625 L414,821.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M617,821.5625 L617,831.5625 L627,831.5625 L617,821.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155" x="420" y="839.1309">Unlock Path 2: Fallback</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="420" y="854.4414">Lua script automatically</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="420" y="869.752">unlocks during SetMinedMulti:</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="420" y="885.0625">if rec[BIN_LOCKED] then</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="428" y="900.373">rec[BIN_LOCKED] = false</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="420" y="915.6836">end</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="146.5" x2="1173" y1="929.4258" y2="929.4258"/><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="151.5" y="940.0605">[</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="136" x="155.5" y="940.0605">Path 3: Quick Validation</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="129" x="295.5" y="940.0605">(Checkpointed Blocks)]</text><path d="M901,948.3809 L901,988.3809 L1163,988.3809 L1163,958.3809 L1153,948.3809 L901,948.3809 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1153,948.3809 L1153,958.3809 L1163,958.3809 L1153,948.3809 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="918" y="965.9492">Only for blocks below checkpoints</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="918" y="981.2598">during initial sync</text><polygon fill="#666666" points="965,1026.623,955,1030.623,965,1034.623,961,1030.623" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="959" x2="1114" y1="1030.623" y2="1030.623"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="971" y="1010.5703">Checkpointed block</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="971" y="1025.8809">received</text><polygon fill="#666666" points="420.5,1055.9336,410.5,1059.9336,420.5,1063.9336,416.5,1059.9336" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="414.5" x2="943" y1="1059.9336" y2="1059.9336"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="426.5" y="1055.1914">Create UTXOs (locked=true)</text><line style="stroke:#666666;stroke-width:1.0;" x1="954" x2="996" y1="1104.5547" y2="1104.5547"/><line style="stroke:#666666;stroke-width:1.0;" x1="996" x2="996" y1="1104.5547" y2="1117.5547"/><line style="stroke:#666666;stroke-width:1.0;" x1="955" x2="996" y1="1117.5547" y2="1117.5547"/><polygon fill="#666666" points="965,1113.5547,955,1117.5547,965,1121.5547,961,1117.5547" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="961" y="1084.502">Validate in parallel</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="961" y="1099.8125">(IgnoreLocked=true)</text><polygon fill="#666666" points="420.5,1142.8652,410.5,1146.8652,420.5,1150.8652,416.5,1146.8652" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="414.5" x2="948" y1="1146.8652" y2="1146.8652"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="426.5" y="1142.123">SetLocked(txHashes, false)</text><path d="M414,1159.8652 L414,1230.8652 L646,1230.8652 L646,1169.8652 L636,1159.8652 L414,1159.8652 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M636,1159.8652 L636,1169.8652 L646,1169.8652 L636,1159.8652 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="211" x="420" y="1177.4336">Unlock Path 3: Quick Validation</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="420" y="1192.7441">Batch unlock for trusted</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="420" y="1208.0547">historical blocks.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="420" y="1223.3652">Optimized path.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="146.5" x2="1173" y1="1237.1074" y2="1237.1074"/><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="151.5" y="1247.7422">[</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137" x="155.5" y="1247.7422">Path 4: Service Recovery</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="144" x="296.5" y="1247.7422">(Block Assembly Restart)]</text><path d="M542,1256.0625 L542,1296.0625 L762,1296.0625 L762,1266.0625 L752,1256.0625 L542,1256.0625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M752,1256.0625 L752,1266.0625 L762,1266.0625 L752,1256.0625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="548" y="1273.6309">Block Assembly service restarts</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="548" y="1288.9414">after unclean shutdown</text><line style="stroke:#666666;stroke-width:1.0;" x1="657.5" x2="699.5" y1="1322.9941" y2="1322.9941"/><line style="stroke:#666666;stroke-width:1.0;" x1="699.5" x2="699.5" y1="1322.9941" y2="1335.9941"/><line style="stroke:#666666;stroke-width:1.0;" x1="658.5" x2="699.5" y1="1335.9941" y2="1335.9941"/><polygon fill="#666666" points="668.5,1331.9941,658.5,1335.9941,668.5,1339.9941,664.5,1335.9941" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="664.5" y="1318.252">loadUnminedTransactions()</text><polygon fill="#666666" points="420.5,1361.3047,410.5,1365.3047,420.5,1369.3047,416.5,1365.3047" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="414.5" x2="646.5" y1="1365.3047" y2="1365.3047"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="426.5" y="1360.5625">Find locked transactions</text><polygon fill="#666666" points="420.5,1390.6152,410.5,1394.6152,420.5,1398.6152,416.5,1394.6152" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="414.5" x2="651.5" y1="1394.6152" y2="1394.6152"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="426.5" y="1389.873">SetLocked(lockedTxHashes, false)</text><path d="M414,1407.6152 L414,1478.6152 L634,1478.6152 L634,1417.6152 L624,1407.6152 L414,1407.6152 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M624,1407.6152 L624,1417.6152 L634,1417.6152 L624,1407.6152 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="420" y="1425.1836">Unlock Path 4: Recovery</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="420" y="1440.4941">Unlock transactions that were</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="420" y="1455.8047">added to Block Assembly but</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="420" y="1471.1152">not yet unlocked due to restart.</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1183" x="0" y="1511.5127"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1183" y1="1511.5127" y2="1511.5127"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1183" y1="1514.5127" y2="1514.5127"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="87" x="548" y="1500.8574"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="69" x="554" y="1517.4258">Final State</text><path d="M263,1539.168 L263,1671.168 L556,1671.168 L556,1549.168 L546,1539.168 L263,1539.168 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M546,1539.168 L546,1549.168 L556,1549.168 L546,1539.168 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121" x="269" y="1556.7363">Phase 2 Complete</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="269" y="1572.0469">All paths lead to: locked=false</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="269" y="1587.3574">Transaction outputs now spendable.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="269" y="1602.668">&#160;</text><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113" x="269" y="1617.9785">Fail-Safe Design:</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="269" y="1633.2891">If Path 1 fails &#8594; Path 2 catches it</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="269" y="1648.5996">If service crashes &#8594; Path 4 catches it</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="269" y="1663.9102">Checkpointed blocks &#8594; Path 3 optimizes it</text><text fill="#333333" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="154" x="0" y="1789.2969">Last Modified On: 9-Dev-2025</text><!--SRC=[fLPjRoCr4Fw-ls9KX4X3Mq5ReIfIGDVqegikkPHB2qWK8U-kDx7gjNEsjxc0-CeFu2VoIvZnElkIRezhkn-Ys1u_dddcyNZidL0hPbWECKlk5aONAXrfgGryCVvcV3OUHxQoI7d62kd6MhbWSkA_XWapHg_3udV-YwAlu89dGd68jKcviP3XAfCIkEGvLyuszkDGk0ty6G6SU-is5ixkUddXl-Ylg86Ie8T6ovV2uAyJYLWnvLuAPNZYc5f8_XIWrsVZq_4PhX3ZSxUHHA5C2HbPmj7rMXzUBPd5VuOfon8dj8AHpdFX1l0AARvHKYTtSCNSqaOH6Y3kNiFuLirrOHA-1yn2-JTgXhtt4vCYPRZDMrIZ27zPJ2VltLp_CeCvpfKWDFIZDiwvz-ELjJoFvSPR-gdjJFIXu0MYlMNP7VFB_byNI702lQzXwhaeIAWqJfPCDCpyC8g6GoXf-tO04u8S3gCoU3ZylWvo0FCYHYgRx1A7ufuvtk2Y-hUpE_pbu1hxMyOLMGCO6KwcD6DlLO-yvUdGcOBlHqhZYX6BfGETDHW6wFT389JrbUIEz_iuxL4WyP0fHL_27U7IY2c4WvY3NI5LiE7k23bBWGxnr5pmH5WIqfKM2dNqyr8aowQIVY2-8YOT7OzZel6TDZcJC5jnuzFGxqFloeYScOtViuz70xI2R-L_K4gers7dXJ20goAMmYx1VOISEqO2V6ZROD-jjUUcl0wD57QTqKZ4dBk9PwldFhvXTda06PEMbviUpmHz_Nw39M8bCE1pGbzWwRvIAsHIhu_2wXksmfHO47dEKu6fanjWcUCchBVl47nTCbFkhZ98WvHtg3JY6CKsOyU3LicOOdbEAMLZhClq43HovaFMzzpKM0VDsrJwTfc5eA4eASYOaFQWd3m6FCUI3YtBE5vEnTr3hslCIXtrjHw4wB6GSd7Fqrj5HHvjXLgqxXSXLT7lreRgc7gkywpgviQqyjYsjcWyXrDy7qNlwLh1V6ofhyGoAHZOn8YL0rOudUEv2TfimdB9iuMqCCH1ouD1i14P4VRh-UMxtoUpqTlN5x-1M_9jpk31uh3KUbZ7x7nIMxlijXHsCe0V2z4groImqP8dToigB5YOF83TbLcjWuFE10BC5CgVkeYuf23cU8iWgQ1ji0lKe4YSm6jdDofviknQ3llpRjLMXCyIsoCr7zeb_ybAHVUfrP2IItm-BXSAJvXy1k8dAX-tpwvzdTdVbZ7cy3tPbWdC8lfdNM0JO2aimfBKGtgtvN6sSY8NVs0QLdZ4qVEbUKgXcdk1p_rxdf3cDYJDdVBwdbk7pKUdEgkkfRCmsm1kIeIj6dqfnxWJoPa2konSgjVgOHZj85f7jMOwtb2fMNgZSge3ZV9kU_lTknkv7mjqeLHWivpQ_zrOYwRSVVrIwM1swgm4Yx3UT0mB6NEmvXKAIrFoNUzc8ovSiA2-1zkT83qqJh7Zn0qXJv-Xg2ePL1gfLqBQKATpHnRO5DKowMhIZjjD6lNdf6JipZWZpmSX0SDj4Mu-qRfmgm8VKOMLZZgtbCMI7qKUVenlxU4SdrRitQnOg877hvza_nR3lt__itsE4xg273iDLzfj5PiOdxlQzBHj-h0ODcnFG8SRwgthdbBopE55roJ_2RCEfZeLcK286LQmBwbyzVRIz70wdHvkyDlRZ_u3]--></g></svg>